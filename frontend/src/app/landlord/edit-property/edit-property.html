<div class="edit-property-container">
  <div class="form-header">
    <h1>Edit Property</h1>
    <p>Update your property details</p>
  </div>

  <!-- Loading State -->
  <div *ngIf="isFetching" class="loading-container">
    <div class="spinner"></div>
    <p>Loading property...</p>
  </div>

  <!-- Error Message -->
  <div *ngIf="errorMessage && !isFetching" class="alert alert-error">
    {{ errorMessage }}
  </div>

  <form *ngIf="!isFetching" (ngSubmit)="onSubmit()" #propertyForm="ngForm">
    <!-- Basic Information -->
    <div class="form-section">
      <h2>Basic Information</h2>
      
      <div class="form-row">
        <div class="form-group">
          <label for="title">Property Title *</label>
          <input
            type="text"
            id="title"
            name="title"
            [(ngModel)]="property.title"
            required
            minlength="5"
            class="form-input"
          />
        </div>
      </div>

      <div class="form-row">
        <div class="form-group full-width">
          <label for="description">Description *</label>
          <textarea
            id="description"
            name="description"
            [(ngModel)]="property.description"
            required
            minlength="20"
            rows="4"
            class="form-input"
          ></textarea>
        </div>
      </div>

      <div class="form-row">
        <div class="form-group">
          <label for="property_type">Property Type *</label>
          <select
            id="property_type"
            name="property_type"
            [(ngModel)]="property.property_type"
            required
            class="form-input"
          >
            <option value="">Select type</option>
            <option *ngFor="let type of propertyTypes" [value]="type">
              {{ type | titlecase }}
            </option>
          </select>
        </div>

        <div class="form-group">
          <label for="price">Monthly Rent (KES) *</label>
          <input
            type="number"
            id="price"
            name="price"
            [(ngModel)]="property.price"
            required
            min="0"
            class="form-input"
          />
        </div>
      </div>
    </div>

    <!-- Location -->
    <div class="form-section">
      <h2>Location</h2>
      
      <div class="form-row">
        <div class="form-group full-width">
          <label for="address">Street Address *</label>
          <input
            type="text"
            id="address"
            name="address"
            [(ngModel)]="property.address"
            required
            class="form-input"
          />
        </div>
      </div>

      <div class="form-row">
        <div class="form-group">
          <label for="city">City *</label>
          <input
            type="text"
            id="city"
            name="city"
            [(ngModel)]="property.city"
            required
            class="form-input"
          />
        </div>

        <div class="form-group">
          <label for="state">State/County *</label>
          <input
            type="text"
            id="state"
            name="state"
            [(ngModel)]="property.state"
            required
            class="form-input"
          />
        </div>
      </div>

      <div class="form-row">
        <div class="form-group">
          <label for="zip_code">Zip Code *</label>
          <input
            type="text"
            id="zip_code"
            name="zip_code"
            [(ngModel)]="property.zip_code"
            required
            class="form-input"
          />
        </div>

        <div class="form-group">
          <label for="country">Country *</label>
          <input
            type="text"
            id="country"
            name="country"
            [(ngModel)]="property.country"
            required
            class="form-input"
          />
        </div>
      </div>

      <div class="form-row">
        <div class="form-group">
          <label for="latitude">Latitude</label>
          <input
            type="number"
            id="latitude"
            name="latitude"
            [(ngModel)]="property.latitude"
            step="0.000001"
            class="form-input"
          />
        </div>

        <div class="form-group">
          <label for="longitude">Longitude</label>
          <input
            type="number"
            id="longitude"
            name="longitude"
            [(ngModel)]="property.longitude"
            step="0.000001"
            class="form-input"
          />
        </div>
      </div>
    </div>

    <!-- Property Details -->
    <div class="form-section">
      <h2>Property Details</h2>
      
      <div class="form-row">
        <div class="form-group">
          <label for="bedrooms">Bedrooms *</label>
          <input
            type="number"
            id="bedrooms"
            name="bedrooms"
            [(ngModel)]="property.bedrooms"
            required
            min="0"
            class="form-input"
          />
        </div>

        <div class="form-group">
          <label for="bathrooms">Bathrooms *</label>
          <input
            type="number"
            id="bathrooms"
            name="bathrooms"
            [(ngModel)]="property.bathrooms"
            required
            min="0"
            step="0.5"
            class="form-input"
          />
        </div>

        <div class="form-group">
          <label for="area_sqft">Area (sqft) *</label>
          <input
            type="number"
            id="area_sqft"
            name="area_sqft"
            [(ngModel)]="property.area_sqft"
            required
            min="0"
            class="form-input"
          />
        </div>
      </div>
    </div>

    <!-- Amenities -->
    <div class="form-section">
      <h2>Amenities</h2>
      <div class="amenities-grid">
        <div *ngFor="let amenity of availableAmenities" class="amenity-item">
          <label>
            <input
              type="checkbox"
              [checked]="isAmenitySelected(amenity)"
              (change)="toggleAmenity(amenity)"
            />
            <span>{{ amenity | titlecase }}</span>
          </label>
        </div>
      </div>
    </div>

    <!-- Images -->
    <div class="form-section">
      <h2>Images</h2>
      <p class="form-note">Image upload temporarily disabled. You can edit other property details.</p>
      
      <!-- Existing Images (Display Only) -->
      <div *ngIf="existingImages.length > 0" class="images-preview">
        <h3>Current Images ({{ existingImages.length }})</h3>
        <div class="images-grid">
          <div *ngFor="let url of existingImages; let i = index" class="image-preview">
            <img [src]="getImageUrl(url)" alt="Property image" />
          </div>
        </div>
      </div>
      
      <div *ngIf="!existingImages || existingImages.length === 0" class="no-images">
        <p>No images uploaded yet</p>
      </div>
    </div>

    <!-- Form Actions -->
    <div class="form-actions">
      <button type="button" (click)="cancel()" class="btn-cancel" [disabled]="isLoading">
        Cancel
      </button>
      <button
        type="submit"
        class="btn-submit"
        [disabled]="!propertyForm.valid || isLoading"
      >
        <span *ngIf="!isLoading">Update Property</span>
        <span *ngIf="isLoading">Updating...</span>
      </button>
    </div>
  </form>
</div>